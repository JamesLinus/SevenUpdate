<!-- Copyright (c) Robert Baker, Seven Software -->
<Page x:Class="SevenUpdate.Sdk.Pages.UpdateShortcuts" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:Controls="clr-namespace:Microsoft.Windows.Controls;assembly=Windows.Shell" mc:Ignorable="d" MinWidth="850" MinHeight="512" KeepAlive="True" d:DesignHeight="512" d:DesignWidth="850">
    <!-- Grid-->
    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Name="grid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="658*" />
            <ColumnDefinition Width="24" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="32" />
            <RowDefinition Height="420*" />
            <RowDefinition Height="44" />
        </Grid.RowDefinitions>
        <Rectangle Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.ColumnSpan="3" Fill="White" />
        <StackPanel Orientation="Horizontal" Grid.ColumnSpan="3">
            <Controls:BackButton Grid.RowSpan="3">
                <Controls:BackButton.CommandBindings>
                    <CommandBinding />
                    <CommandBinding Command="NavigationCommands.BrowseBack" />
                </Controls:BackButton.CommandBindings>
            </Controls:BackButton>
            <TextBlock Text="Shortcuts" VerticalAlignment="Center" FontSize="14" Margin="15,-2,0,0">
				<TextBlock.Effect>
					<DropShadowEffect Color="White" BlurRadius="10" RenderingBias="Performance" ShadowDepth="0" Direction="0" />
				</TextBlock.Effect>
            </TextBlock>
        </StackPanel>
        <!--Help Text-->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="1" Grid.Row="1" Margin="30,0,0,0" Name="spHelp">
            <Image RenderOptions.BitmapScalingMode="HighQuality" Source="/SevenUpdate.Sdk;component/Images/LeftArrow.png" Width="45" Height="45" Stretch="None" HorizontalAlignment="Center"
                    VerticalAlignment="Center" />
            <TextBlock Text="To get started, right click the list box and create or import a shortcut" HorizontalAlignment="Left" Padding="2" Grid.Column="1" VerticalAlignment="Center"
                    FontSize="18" Foreground="#FF003399" Grid.Row="1" Margin="10,0,0,0" />
        </StackPanel>
        <!--Navigation Buttons-->
        <Line Stroke="#FFA0A0A0" VerticalAlignment="Top" Grid.Row="2" X1="{Binding Path=ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type Page}}}" StrokeThickness="1"
                Grid.ColumnSpan="3" Name="line" />
        <Rectangle Grid.ColumnSpan="3" Grid.Row="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Fill="#FFF0F0F0" Name="rectangle" />
        <StackPanel Grid.Row="2" HorizontalAlignment="Right" VerticalAlignment="Center" Orientation="Horizontal" Margin="0,0,10,0" Grid.ColumnSpan="2" Grid.Column="1">
            <Button HorizontalContentAlignment="Center" IsDefault="True" MinHeight="23" MinWidth="75" Padding="5,1" VerticalContentAlignment="Center" Content="_Next" Click="Button_Click" />
            <Button Content="Cancel" HorizontalContentAlignment="Center" IsDefault="False" MinHeight="23" MinWidth="75" Padding="5,1" VerticalContentAlignment="Center" Margin="6,0,0,0" IsCancel="True"
                    Click="Cancel_Click" />
        </StackPanel>
        <ListBox BorderBrush="LightGray" HorizontalAlignment="Left" Margin="10" Name="listBox" SelectedIndex="0" VerticalAlignment="Stretch" Width="150" Grid.Row="1"
                SelectionChanged="listBox_SelectionChanged">
            <ListBox.ContextMenu>
                <ContextMenu>
                    <MenuItem Click="AddShortcut_Click" Header="Add Registry Item" Name="miAddShortcut" />
                    <MenuItem Click="ImportShortcut_Click" Header="Import Registry File" Name="miImportShortcut" />
                    <Separator />
                    <MenuItem Header="Remove Shortcut" Name="miRemove" Click="miRemove_Click" />
                    <MenuItem Header="Remove All Shortcuts" Name="miRemoveAll" Click="miRemoveAll_Click">
                        <MenuItem.Icon>
                            <Image Source="/SevenUpdate.Sdk;component/Images/Delete.png" />
                        </MenuItem.Icon>
                    </MenuItem>
                </ContextMenu>
            </ListBox.ContextMenu>
        </ListBox>
        <StackPanel Grid.Column="1" Grid.Row="1" Name="spInput" Visibility="Collapsed">
            <GroupBox Grid.Column="1" Grid.Row="1" Header="Shortcut Action" HorizontalAlignment="Left" Margin="10">
                <StackPanel Orientation="Horizontal">
                    <RadioButton Content="Add/Update" Height="16" Margin="10" ToolTip="Creates or updates the shortcut" IsChecked="True" />
                    <RadioButton Content="Update only" Height="16" Margin="10" ToolTip="Updates the shortcut only if it exists on the system" />
                    <RadioButton Content="Delete shortcut" Height="16" Margin="10" ToolTip="Deletes the shortcut on the system" />
                </StackPanel>
            </GroupBox>
            <TextBlock Text="Shortcut save location:" ToolTip="The location where the shortcut resides, example: startmenu or desktop" HorizontalAlignment="Left" />
            <StackPanel Orientation="Horizontal">
                <Controls:InfoTextBox Margin="2,0,0,0" MinWidth="580" Name="tbxShortcutPath" Label="%DESKTOP%\My Shortcut.lnk" TextChanged="Textbox_TextChanged" />
                <TextBlock Style="{StaticResource underlineTextBlock}" Padding="2" Text="Browse" ToolTip="Click to locate the file location" HorizontalAlignment="Left" VerticalAlignment="Center"
                        Margin="2,0,0,0" Foreground="#FF0066CC" Name="tbPath" MouseDown="BrowsePath_MouseDown" Cursor="Hand" />
                <Image Margin="4,0" Name="imgShortcutPath" Source="/SevenUpdate.Sdk;component/Images/Caution.png" ToolTip="The path entered is not valid." Visibility="Collapsed"
                        UseLayoutRounding="True" />
            </StackPanel>
            <TextBlock Text="Shortcut target:" ToolTip="The app or path the shortcut points to" HorizontalAlignment="Left" Margin="0,10,0,0" />
            <StackPanel Orientation="Horizontal">
                <Controls:InfoTextBox Margin="2,0,0,0" MinWidth="580" Name="tbxShortcutTarget" Label="%PROGRAMFILES%\MyApp\MyApp.exe" TextChanged="Textbox_TextChanged" />
                <TextBlock Style="{StaticResource underlineTextBlock}" Padding="2" Text="Browse" ToolTip="Click to locate the file location" HorizontalAlignment="Left" VerticalAlignment="Center"
                        Margin="2,0,0,0" Foreground="#FF0066CC" Name="tbBrowseTarget" MouseDown="BrowseTarget_MouseDown" Cursor="Hand" />
                <Image Margin="4,0" Name="imgShortcutTarget" Source="/SevenUpdate.Sdk;component/Images/Caution.png" ToolTip="The path entered is not valid." Visibility="Collapsed"
                        SnapsToDevicePixels="True" UseLayoutRounding="True" />
            </StackPanel>
            <TextBlock Text="Shortcut icon:" ToolTip="A path pointing to an ico to use as the shortcut icon" HorizontalAlignment="Left" Margin="0,10,0,0" />
            <StackPanel Orientation="Horizontal">
                <Controls:InfoTextBox Margin="2,0,0,0" MinWidth="580" Name="tbxShortcutIcon" Label="%PROGRAMFILES%\MyApp\MyApp.exe,0" TextChanged="Textbox_TextChanged" />
                <TextBlock Style="{StaticResource underlineTextBlock}" Padding="2" Text="Browse" ToolTip="Click to locate the file location" HorizontalAlignment="Left" VerticalAlignment="Center"
                        Margin="2,0,0,0" Foreground="#FF0066CC" Name="tbBrowseIcon" MouseDown="BrowseIcon_MouseDown" Cursor="Hand" />
                <Image Margin="4,0" Name="imgShortcutIcon" Source="/SevenUpdate.Sdk;component/Images/Caution.png" ToolTip="The path entered is not valid." Visibility="Collapsed"
                        UseLayoutRounding="True" />
            </StackPanel>
            <TextBlock Text="Shortcut description:" ToolTip="A simple description of the target exe" HorizontalAlignment="Left" Margin="0,10,0,0" />
            <StackPanel Orientation="Horizontal">
                <Controls:InfoTextBox Label="TestValue" Margin="2,0,0,0" MinWidth="625" Name="tbxShortcutDescription" />
            </StackPanel>
            <TextBlock Text="Shortcut arguments:" HorizontalAlignment="Left" Margin="0,10,0,0" ToolTip="The command line arguments for the shortcut" />
            <StackPanel Orientation="Horizontal">
                <Controls:InfoTextBox Label="TestValue" Margin="2,0,0,0" MinWidth="625" Name="infoTextBox1" ToolTip="-myarg" />
            </StackPanel>
        </StackPanel>
    </Grid>
</Page>